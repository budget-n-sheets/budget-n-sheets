<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <meta charset="UTF-8">
  <link rel="stylesheet" href="<?= HtmlResources.css.add_ons ?>">
  <?!= HtmlService2.htmlInclude("html/resources/animation-processing"); ?>
  <style>
    .message {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .timeout {
      display: none;
    }

    .animation-processing-wrapper {
      width: 137px;
      height: 5px;
    }

    .animation-processing-bar {
      width: 79px;
      height: 5px;
      animation-duration: 1201ms;
      animation-name: animateProcessingBar;
    }

    @keyframes animateProcessingBar {
      from {
        left: -137px;
      }

      to {
        left: 137px;
      }
    }
  </style>
</head>

<body>
  <div class="message">
    <h2><?= message ?></h2>

    <div class="animation-processing-wrapper">
      <div class="animation-processing-bar"></div>
    </div>
  </div>
  <div class="timeout">
    <p>It is taking longer than expected. You can try again or <a style="font-weight: bold;" href="<?= send_feedback ?>" target="_blank">report a problem</a>.</p>

    <button onclick="google.script.host.close()">Close</button>
  </div>

  <? if (hasTimeout) { ?>
  <script src="<?= HtmlResources.js.jquery_min ?>"></script>
  <script>
    window.onload = function() {
      setTimeout(function() {
        google.script.host.setHeight(173);
        $(".timeout").fadeIn();
      }, 60000);
    }
  </script>
  <? } ?>
</body>

</html>
