<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <meta charset="UTF-8">
  <?!= HtmlService2.htmlInclude("html/resources/styles"); ?>
  <?!= HtmlService2.htmlInclude("html/resources/containers"); ?>
  <?!= HtmlService2.htmlInclude("html/resources/material-icons"); ?>
  <style>
    h1 {
      flex: 1;
      margin: 0;
    }

    a {
      font-weight: bold;
    }

    ul {
      margin: 0;
      padding: 0 1em;
      text-align: justify;
    }

    .b-play {
      cursor: pointer;
    }

    .topic-header {
      margin: 1em 0;
      display: flex;
      align-items: center;
    }

    .m-expand, .m-collapse {
      cursor: pointer;
      margin: 0 7px;
      border-radius: 50%;
    }

    .m-expand:hover, .m-collapse:hover {
      background: #f3f3f3;
    }
  </style>
</head>

<body>
  <div class="content-container">
    <div>
      <p>Select <strong>Extensions</strong> &gt; <strong>Budget n Sheets</strong> &gt; <strong>More</strong> &gt; <strong>Show Quickstart</strong> to revisit this <strong>Quickstart</strong>.</p>
      <p>In each topic, click the <span class="material-icons md-18">play_circle_outline</span> button to play a demo.</p>
    </div>

    <hr>

    <div>
      <div class="topic-header">
        <h1>Basics</h1>
        <div class="m-collapse"><span class="material-icons md-24">expand_less</span></div>
      </div>
      <div>
        <h2>Decimal separator</h2>
        <p>Your spreadsheet uses <strong>&quot;<?= dec_p ?>&quot;</strong> (<?= dec_n ?>) as decimal separator.</p>

        <h2>Plus and minus signs</h2>
        <p><strong>Positive numbers:</strong> whenever values are <strong>towards</strong> your balance.</p>
        <p><strong>Negative numbers:</strong> whenever values are <strong>outwards</strong> your balance.</p>

        <h2>Protected sheets and ranges</h2>
        <p>Do <strong>not</strong> edit protected tabs and ranges! It might break the spreadsheet functionality.</p>
        <p>It is <strong>safe</strong> to: show/hide tabs, expand/collapse column and row groups, show/hide columns and rows.</p>

        <h2>Privacy and Security</h2>
        <p>The add-on Budget n Sheets does not collect your data, settings or any personal data. Everything is processed within your buget spreadsheet.</p>

        <ul>
          <li><a href="https://support.google.com/accounts/answer/46526" target="_blank">Make your Google Account more secure</a></li>
          <li><a href="https://support.google.com/docs/answer/10381817" target="_blank">Understand the basics of privacy in Google Sheets</a></li>
          <li><a href="<?= home_wiki ?>/Deactivate-or-Uninstall" target="_blank">Learn how to deactivate or uninstall the add-on</a></li>
        </ul>

        <p>The content you save in Google Sheets is private to you, from others, unless you choose to share it. <a href="https://support.google.com/drive/answer/2494893" target="_blank">Learn how to share or stop sharing files in Google Sheets</a>.</p>

        <p>Use caution when sharing your Google Calendar and choose what others can access. <a href="https://support.google.com/calendar/answer/37082" target="_blank">Learn how to share or stop sharing your calendar with someone</a>.</p>

        <h2>Support</h2>
        <ul>
          <li><a href="<?= send_feedback ?>" target="_blank">Share your ideas, feedback, and issues</a></li>
        </ul>

        <p>You are encouraged to join our community at <a href="<?= join_subreddit ?>" target="_blank">r/budgetnsheets</a> to discuss feature requests, make questions, and share your feedback on the latest changes.</p>
      </div>
    </div>

    <hr>

    <div>
      <div class="topic-header">
        <h1>Registering Transactions</h1>
        <div class="m-collapse"><span class="material-icons md-24">expand_less</span></div>
      </div>
      <div>
        <ul>
          <li>Expenses with <strong>cash</strong> <span class="b-play material-icons md-18" id="statements1">play_circle_outline</span></li>
          <li>Expenses with <strong>debit card</strong> <span class="b-play material-icons md-18" id="statements2">play_circle_outline</span></li>
          <li>Expenses with <strong>credit card</strong>: See <strong>Accounts and Cards</strong>.</li>
          <li>Register income <span class="b-play material-icons md-18" id="statements3">play_circle_outline</span></li>
          <li>Ignore a value <span class="b-play material-icons md-18" id="statements4">play_circle_outline</span></li>
        </ul>

        <h2>Account transactions</h2>
        <ul>
          <li>Deposits <span class="b-play material-icons md-18" id="transactions1">play_circle_outline</span></li>
          <li>Withdrawals <span class="b-play material-icons md-18" id="transactions4">play_circle_outline</span></li>
          <li>Transfer from someone <span class="b-play material-icons md-18" id="transactions2">play_circle_outline</span></li>
          <li>Transfer to someone <span class="b-play material-icons md-18" id="transactions3">play_circle_outline</span></li>
        </ul>

        <h2>Cash flow</h2>
        <ul>
          <li>After entering expenses and transactions, update the cash flow. <span class="b-play material-icons md-18" id="cash_flow1">play_circle_outline</span></li>
        </ul>
      </div>
    </div>

    <hr>

    <div>
      <div class="topic-header">
        <h1>Accounts and Cards</h1>
        <div class="m-collapse"><span class="material-icons md-24">expand_less</span></div>
      </div>
      <div>
        <ul>
          <li>Set an initial month and balance for each account. From the initial month and onwards, the balance is affected by the transactions. <span class="b-play material-icons md-18" id="acc_cards1">play_circle_outline</span></li>
          <li>Create a <strong>card</strong> for each credit card. <span class="b-play material-icons md-18" id="acc_cards2">play_circle_outline</span></li>
          <li>Register card expenses and refunds <span class="b-play material-icons md-18" id="acc_cards3">play_circle_outline</span></li>
          <li>Register card bill payment <span class="b-play material-icons md-18" id="acc_cards4">play_circle_outline</span></li>
        </ul>
      </div>
    </div>

    <hr>

    <div>
      <div class="topic-header">
        <h1>Custom Tags</h1>
        <div class="m-collapse"><span class="material-icons md-24">expand_less</span></div>
      </div>
      <div>
        <p>Use tags to track specific transactions and generate analytics by tag and category.</p>
        <p><strong>Note</strong> The accepted charset for a code is: 0-9, a-z, A-Z, _</p>

        <ul>
          <li>Create a tag <span class="b-play material-icons md-18" id="tags1">play_circle_outline</span></li>
          <li>Create subtags <span class="b-play material-icons md-18" id="tags3">play_circle_outline</span></li>
          <li>Tag some expenses <span class="b-play material-icons md-18" id="tags2">play_circle_outline</span></li>
          <li>Import an analytics sheet from the <strong>BnS Gallery</strong> <span class="b-play material-icons md-18" id="tags4">play_circle_outline</span></li>
        </ul>
      </div>
    </div>
    <? if (isCurrent) { ?>

    <hr>

    <div>
      <div class="topic-header">
        <h1>Financial Calendar</h1>
        <div class="m-collapse"><span class="material-icons md-24">expand_less</span></div>
      </div>
      <div>
        <p><a href="https://github.com/guimspace/budget-n-sheets/wiki/Financial-Calendar" target="_blank">Lern how to sync your Google Calendar with the spreadsheet.</a>.</p>

        <ul>
          <li>Set a financial calendar <span class="b-play material-icons md-18" id="calendar1">play_circle_outline</span></li>
          <li>Create calendar events and sync with the cash flow <span class="b-play material-icons md-18" id="calendar2">play_circle_outline</span></li>
        </ul>

        <p>Open your <a href="https://calendar.google.com/" target="_blank">calendar</a> and check how each calendar event was composed.</p>
      </div>
    </div>

    <? } ?>
    <hr>

    <div>
      <h3>Was this Quickstart helpful?</h3>

      <a href="https://docs.google.com/forms/d/e/1FAIpQLSeAkAgJYuABKsdz1S8fFT8wdZ1tJkw3V_xbQtbJ27tq5mnx-w/viewform?usp=pp_url&entry.1588138887=Yes" target="_blank"><button>Yes</button></a>
      <a href="https://docs.google.com/forms/d/e/1FAIpQLSeAkAgJYuABKsdz1S8fFT8wdZ1tJkw3V_xbQtbJ27tq5mnx-w/viewform?usp=pp_url&entry.1588138887=No" target="_blank"><button>No</button></a>
    </div>
  </div>

  <?!= HtmlService2.htmlInclude("html/resources/javascript"); ?>
  <script>
    const $bplay = $('.b-play');
    const $container = $('.content-container');

    $bplay.one('click', playDemo);

    $('.m-expand, .m-collapse').click(function() {
      if ($(this).hasClass('m-collapse')) {
        $(this).attr('class', 'm-expand');
        $(this).children().text('expand_more');
        $(this).parent().siblings().hide();
      } else {
        $(this).attr('class', 'm-collapse');
        $(this).children().text('expand_less');
        $(this).parent().siblings().show();
      }
    });

    function playDemo () {
      $bplay.off('click');
      $container.css('opacity', 0.61);

      google.script.run
        .withFailureHandler(showError)
        .withSuccessHandler(e => {
          $bplay.one('click', playDemo);
          $container.css('opacity', 1);
        })
        .playQuickstart(this.id);
    }
  </script>
</body>

</html>
