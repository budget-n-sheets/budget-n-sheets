<script>
  $(document).ready(function() {
    $("#b-Reinstall").click(reinstallTriggers);
    <? if (!isOwner || isSharedDrive) { ?>
    $("#b-Transfer").click(transferAdminRole);
    <? } ?>

    $("#b-Reset").click(resetProtection);
  });

  <? if (!isOwner || isSharedDrive) { ?>
  function transferAdminRole() {
    this.disabled = true;
    $("#footer_response").empty();

    google.script.run.withSuccessHandler(function(r, o) {
        o.disabled = false;
        if (!r) google.script.host.close();
      })
      .withFailureHandler(showError)
      .withUserObject(this)
      <? if (isSharedDrive) { ?>
      .askTransferAdminSd();
      <? } else { ?>
      .askTransferAdmin();
      <? } ?>
  }
  <? } ?>

  function reinstallTriggers() {
    this.disabled = true;
    $("#footer_response").empty();

    google.script.run.withSuccessHandler(function(r, o) {
        if (!r) showStatus("Reinstalled triggers");
        o.disabled = false;
      })
      .withFailureHandler(showError)
      .withUserObject(this)
      .askReinstallTriggersUi();
  }

  function resetProtection() {
    this.disabled = true;
    $("#footer_response").empty();

    google.script.run.withSuccessHandler(function(r, o) {
        showStatus("Reseted protection");
        o.disabled = false;
      })
      .withFailureHandler(showError)
      .withUserObject(this)
      .askResetProtection();
  }
</script>
