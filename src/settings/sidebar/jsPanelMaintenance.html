<script>
  $(document).ready(function() {
    $('#b-Reset1').click(resetProtection);
    $('#b-Reset2').click(resetSuggestions);
    $('#b-Reinstall').click(reinstallTriggers);
  });

  function resetProtection () {
    this.disabled = true;
    $('.current').empty();

    google.script.run.withSuccessHandler(function(r, o) {
        showStatus('Reseted protection');
        o.disabled = false;
      })
      .withFailureHandler(showError)
      .withUserObject(this)
      .askResetProtection();
  }

  function resetSuggestions () {
    this.disabled = true;
    $('.current').empty();

    google.script.run.withSuccessHandler(function(r, o) {
        showStatus('Reseted suggestions');
        o.disabled = false;
      })
      .withFailureHandler(showError)
      .withUserObject(this)
      .askResetSuggestions();
  }

  function reinstallTriggers () {
    this.disabled = true;
    $('.current').empty();

    google.script.run.withSuccessHandler(function(r, o) {
        if (!r) showStatus('Reinstalled triggers');
        o.disabled = false;
      })
      .withFailureHandler(showError)
      .withUserObject(this)
      .askReinstallTriggersUi();
  }
</script>
