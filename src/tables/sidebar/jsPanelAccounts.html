<script>
  $(document).ready(function() {
    google.script.run
      .withSuccessHandler(listAccounts)
      .withFailureHandler(showError)
      .accountsClientService({ job: 'list' });
  });

  $(document).on('click', '.a-edit', function(e) {
    google.script.run
      .withSuccessHandler(responseHandler)
      .withFailureHandler(showError)
      .showDialogEditAccount($(this).parent().attr('id'));
  });

  function listAccounts (db_accounts) {
    const $box = $('#panel-accounts');

    for (const id in db_accounts) {
      const $text = $('<div>').attr({class: 'text'}).append([
        $('<strong>').text(db_accounts[id].name)
      ]);
      const $icons = $('<div>').attr({class: 'md-box', id: id}).append([
        $('<span>').attr({class: 'a-edit material-icons md-18'}).text('edit')
      ]);

      $box.append($('<div>').attr({class: 'item'}).append([$text, $icons]));
    }

    $('#panel-accounts > div:not(:first-child)').before('<hr>');
    $box.show();
  }
</script>
